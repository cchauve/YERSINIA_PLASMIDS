
Starting Unicycler (2022-06-02 12:46:34)
----------------------------------------
    Welcome to Unicycler, an assembly pipeline for bacterial genomes. Since you provided only short reads, Unicycler will essentially function as a SPAdes-optimiser. It will try many k-mer sizes, choose the best based on contig length and graph connectivity, and scaffold the graph using SPAdes repeat resolution.
    For more information, please see https://github.com/rrwick/Unicycler

Command: /home/chauvec/projects/ctb-chauvec/jsiele/bin/Unicycler/unicycler-runner.py -o short -1 short_1.fastq.gz -2 short_2.fastq.gz -t 8 --keep 0

Unicycler version: v0.5.0
Using 8 threads

Making output directory:
  /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short

Dependencies:
  Program       Version   Status  
  spades.py     3.15.3    good    
  racon                   not used
  makeblastdb   2.12.0+   good    
  tblastn       2.12.0+   good    


Choosing k-mer range for assembly (2022-06-02 12:46:46)
-------------------------------------------------------
    Unicycler chooses a k-mer range for SPAdes based on the length of the input reads. It uses a wide range of many k-mer sizes to maximise the chance of finding an ideal assembly.

SPAdes maximum k-mer: 127
Median read length: 250
K-mer range: 27, 53, 71, 87, 99, 111, 119, 127


SPAdes assemblies (2022-06-02 12:46:58)
---------------------------------------
    Unicycler now uses SPAdes to assemble the short reads. It scores the assembly graph for each k-mer using the number of contigs (fewer is better) and the number of dead ends (fewer is better). The score function is 1/(c*(d+2)), where c is the contig count and d is the dead end count.

spades.py -o /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly -k 27 --threads 8 --isolate -1 /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short_1.fastq.gz -2 /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short_2.fastq.gz -m 1024

spades.py -o /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly -k 27,53 --threads 8 --restart-from k27 -m 1024

spades.py -o /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly -k 27,53,71 --threads 8 --restart-from k53 -m 1024

spades.py -o /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly -k 27,53,71,87 --threads 8 --restart-from k71 -m 1024

spades.py -o /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly -k 27,53,71,87,99 --threads 8 --restart-from k87 -m 1024

spades.py -o /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly -k 27,53,71,87,99,111 --threads 8 --restart-from k99 -m 1024

spades.py -o /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly -k 27,53,71,87,99,111,119 --threads 8 --restart-from k111 -m 1024

spades.py -o /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly -k 27,53,71,87,99,111,119,127 --threads 8 --restart-from k119 -m 1024

K-mer   Contigs   Dead ends   Score   
   27     3,038          19   1.57e-05
   53     2,343          15   2.51e-05
   71     2,226          15   2.64e-05
   87     2,083          16   2.67e-05 ← best
   99     2,016          17   2.61e-05
  111     1,957          19   2.43e-05
  119     1,918          21   2.27e-05
  127     1,870          19   2.55e-05

Read depth filter: removed 129 contigs totalling 49308 bp
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/001_spades_graph_k027.gfa
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/001_spades_graph_k053.gfa
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/001_spades_graph_k071.gfa
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/001_spades_graph_k087.gfa
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/001_spades_graph_k099.gfa
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/001_spades_graph_k111.gfa
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/001_spades_graph_k119.gfa
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/001_spades_graph_k127.gfa
Deleting /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/spades_assembly/


Determining graph multiplicity (2022-06-02 13:40:33)
----------------------------------------------------
    Multiplicity is the number of times a sequence occurs in the underlying sequence. Single-copy contigs (those with a multiplicity of one, occurring only once in the underlying sequence) are particularly useful.


Cleaning graph (2022-06-02 13:40:36)
------------------------------------
    Unicycler now performs various cleaning procedures on the graph to remove overlaps and simplify the graph structure. The end result is a graph ready for bridging.

Graph overlaps removed

Removed zero-length segments:
    676, 678, 688, 691, 696, 698, 699, 707, 712, 713, 714, 716, 733, 737, 739, 745, 748, 751, 755, 762, 763, 764, 767, 768, 770, 774, 775, 776, 789, 792, 794, 797, 800, 802, 805, 812, 837, 838, 839, 840, 841, 843, 850, 852, 856, 857, 858, 860, 863, 867, 871, 874, 875, 876, 877, 878, 881, 882, 884, 887, 897, 903, 905, 908, 909, 911, 913, 918, 920, 927, 928, 931, 943, 944, 945, 949, 950, 951, 952, 954, 956, 957, 961, 965, 967, 968, 969, 970, 971, 972, 973, 975, 976, 980, 983, 985, 986, 994, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1009, 1010, 1011, 1022, 1026, 1027, 1030, 1032, 1033, 1034, 1038, 1041, 1042, 1044, 1045, 1046, 1048, 1050, 1055, 1056, 1058, 1060, 1061, 1065, 1066, 1068, 1073, 1077, 1078, 1081, 1082, 1088, 1093, 1094, 1095, 1097, 1100, 1101, 1102, 1105, 1109, 1110, 1111, 1112, 1113, 1117, 1120, 1122, 1124, 1126, 1127, 1130, 1134, 1136, 1143, 1145, 1147, 1152, 1155, 1158, 1160, 1164, 1165, 1172, 1175, 1178, 1180, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1193, 1195, 1196, 1197, 1199, 1200, 1201, 1208, 1209, 1211, 1213, 1216, 1218, 1219, 1220, 1223, 1225, 1227, 1228, 1229, 1230, 1231, 1232, 1233, 1234, 1235, 1237, 1239, 1240, 1245, 1249, 1252, 1254, 1255, 1259, 1264, 1265, 1267, 1270, 1271, 1272, 1275, 1277, 1279, 1282, 1283, 1285, 1288, 1290, 1293, 1295, 1296, 1299, 1300, 1302, 1306, 1307, 1309, 1311, 1313, 1314, 1315, 1317, 1320, 1321, 1322, 1323, 1324, 1325, 1326, 1328, 1331, 1332, 1333, 1334, 1337, 1338, 1340, 1343, 1346, 1347, 1348, 1355, 1366, 1369, 1370, 1371, 1372, 1374, 1375, 1378, 1379, 1381, 1382, 1383, 1384, 1386, 1389, 1393, 1397, 1398, 1406, 1414, 1417, 1423, 1424, 1427, 1428, 1429, 1430, 1434, 1435, 1439, 1445, 1447, 1454, 1458, 1459, 1460, 1473, 1479, 1481, 1482, 1483, 1487, 1489, 1490, 1492, 1496, 1508, 1513, 1517, 1519, 1521, 1522, 1527, 1528, 1531, 1532, 1536, 1537, 1540, 1541, 1544, 1546, 1548, 1550, 1565, 1573, 1580, 1581, 1586, 1588, 1590, 1609, 1620, 1632, 1651, 1654, 1670, 1678, 1679, 1680, 1685, 1694, 1703, 1709, 1710, 1714, 1715, 1716, 1723, 1728, 1732, 1734, 1737, 1740, 1746, 1756, 1758, 1760, 1766, 1773, 1777, 1780, 1785, 1803, 1804, 1805, 1808, 1819, 1820, 1821, 1822, 1827, 1839, 1840, 1842, 1861, 1873, 1876, 1903, 1930, 1943, 1949, 1951, 1952, 1953, 1963, 1969, 1971, 1978, 1981, 1982, 1983, 1996, 2005, 2007, 2008, 2009, 2011, 2013, 2015, 2016, 2021, 2029, 2033, 2053

Removed zero-length segments:
    667, 738, 750, 753, 765, 771, 784, 793, 796, 814, 822, 825, 828, 832, 854, 910, 919, 921, 925, 960, 963, 981, 1013, 1024, 1028, 1040, 1043, 1051, 1054, 1057, 1080, 1099, 1108, 1168, 1177, 1217, 1226, 1246, 1248, 1251, 1260, 1286, 1289, 1291, 1319, 1360, 1391, 1395, 1403, 1440, 1441, 1443, 1444, 1470, 1476, 1516, 1526, 1534, 1538, 1542, 1543, 1545, 1563, 1610, 1619, 1781, 1786, 1790, 1807, 1826, 1847, 1904, 1908, 1912, 1980, 1984, 1994, 1995, 2014, 2017, 2020, 2025, 2034

Removed zero-length segments:
    695, 1023, 1025, 1035, 1206, 1305, 1362, 1425, 1529, 1669, 1874, 1883, 1886, 1896, 1905, 1909, 1939, 1948, 1979, 1985, 1998, 2019, 2089, 2093

Removed zero-length segments:
    1121, 1242, 1465, 1967, 1977, 1986, 1988, 2103

Removed zero-length segments:
    1935, 1976, 1987

Removed zero-length segments:
    1975

Removed zero-length segments:
    1974

Removed zero-length segments:
    1973

Merged small segments:
    1294, 1308, 1316, 1335, 1336, 1341, 1345, 1351, 1353, 1356, 1358, 1361, 1364, 1380, 1387, 1388, 1390, 1394, 1400, 1402, 1404, 1405, 1407, 1408, 1409, 1411, 1413, 1415, 1416, 1418, 1422, 1432, 1436, 1442, 1446, 1450, 1455, 1457, 1461, 1462, 1463, 1464, 1466, 1468, 1469, 1471, 1472, 1474, 1478, 1480, 1485, 1486, 1488, 1491, 1493, 1494, 1495, 1497, 1498, 1500, 1501, 1502, 1504, 1505, 1506, 1507, 1511, 1515, 1518, 1520, 1524, 1547, 1549, 1551, 1552, 1553, 1555, 1556, 1557, 1558, 1559, 1562, 1566, 1567, 1568, 1569, 1571, 1572, 1574, 1575, 1577, 1578, 1579, 1582, 1583, 1584, 1585, 1587, 1589, 1591, 1593, 1595, 1596, 1598, 1599, 1600, 1603, 1604, 1605, 1606, 1608, 1611, 1612, 1613, 1614, 1615, 1616, 1617, 1618, 1621, 1622, 1623, 1624, 1625, 1626, 1627, 1628, 1630, 1631, 1633, 1634, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1644, 1645, 1646, 1648, 1649, 1652, 1653, 1655, 1656, 1657, 1658, 1659, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1668, 1672, 1673, 1675, 1676, 1677, 1682, 1683, 1687, 1688, 1689, 1690, 1691, 1692, 1693, 1696, 1697, 1699, 1700, 1701, 1704, 1705, 1706, 1707, 1708, 1711, 1712, 1713, 1717, 1719, 1721, 1722, 1724, 1725, 1726, 1727, 1730, 1731, 1733, 1735, 1736, 1738, 1739, 1741, 1743, 1745, 1747, 1748, 1749, 1751, 1752, 1754, 1755, 1757, 1759, 1761, 1762, 1763, 1765, 1769, 1770, 1771, 1772, 1774, 1775, 1776, 1779, 1782, 1783, 1784, 1787, 1789, 1791, 1792, 1793, 1794, 1795, 1796, 1797, 1798, 1800, 1801, 1802, 1806, 1809, 1810, 1811, 1814, 1817, 1818, 1823, 1824, 1825, 1828, 1829, 1831, 1832, 1833, 1834, 1835, 1836, 1837, 1838, 1843, 1844, 1845, 1846, 1848, 1850, 1851, 1852, 1853, 1854, 1855, 1857, 1858, 1859, 1860, 1863, 1864, 1865, 1866, 1867, 1868, 1869, 1870, 1871, 1872, 1875, 1877, 1878, 1880, 1881, 1882, 1890, 1891, 1892, 1893, 1894, 1895, 1897, 1899, 1900, 1901, 1902, 1907, 1911, 1914, 1916, 1919, 1920, 1922, 1924, 1925, 1926, 1927, 1928, 1929, 1931, 1932, 1933, 1934, 1937, 1938, 1940, 1941, 1942, 1947, 1955, 1958, 1959, 1964, 1965, 1966, 1990, 1991, 1992, 1999, 2000, 2001, 2003, 2004, 2023, 2024, 2026, 2028, 2030, 2031, 2032, 2035, 2036, 2037, 2038, 2039, 2040, 2041, 2042, 2043, 2045, 2046, 2047, 2048, 2049, 2050, 2052, 2054, 2055, 2056, 2058, 2060, 2061, 2062, 2063, 2064, 2065, 2066, 2067, 2069

    Unicycler now selects a set of anchor contigs from the single-copy contigs. These are the contigs which will be connected via bridges to form the final assembly.

407 anchor segments (3,447,683 bp) out of 1,198 total segments (3,554,555 bp)


Creating SPAdes contig bridges (2022-06-02 13:40:38)
----------------------------------------------------
    SPAdes uses paired-end information to perform repeat resolution (RR) and produce contigs from the assembly graph. SPAdes saves the graph paths corresponding to these contigs in the contigs.paths file. When one of these paths contains two or more anchor contigs, Unicycler can create a bridge from the path.

                                                                                                                                                  Bridge
Start                                                                Path                                                                End     quality
 -278                                                                -595                                                                375        45.8
 -234                                                            -824 → -1006                                                            389        47.7
 -166                                                            1034 → 1034                                                             330        40.7
  -76                                                         -937 → 579 → -549                                                          133        62.9
  -11   596 → -1146 → 498 → -1154 → -513 → 947 → 522 → 601 → 578 → -1167 → -537 → -1166 → -577 → -710 → -504 → -986 → -478 → 855 → 592   67         19.2
    8                                                          512 → 850 → -917                                                          -161       55.6
   29                                                               -1050                                                                -104       35.4
   31                                           -488 → -663 → -587 → 1143 → 517 → 1158 → -492                                            12         28.6
   47                                                         -715 → -670 → 933                                                          -371       63.2
   49                                      492 → 1160 → -517 → -1163 → 587 → 664 → 488 → -495 → 612                                      191        17.4
   79                     812 → -1006 → -928 → -1030 → -1028 → 748 → -889 → -677 → -921 → -1139 → 817 → -991 → -880                      292        51.7
  146                                                               -1059                                                                219        60.2
  202                                                         670 → 715 → -1015                                                          261        63.0
  226                                                         963 → 1015 → -715                                                          -342       56.7
  266                                                                576                                                                 65         63.0
  338                                                                612                                                                 411        52.1


Creating loop unrolling bridges (2022-06-02 13:40:38)
-----------------------------------------------------
    When a SPAdes contig path connects an anchor contig with the middle contig of a simple loop, Unicycler concludes that the sequences are contiguous (i.e. the loop is not a separate piece of DNA). It then uses the read depth of the middle and repeat contigs to guess the number of times to traverse the loop and makes a bridge.

No loop unrolling bridges made


Applying bridges (2022-06-02 13:40:38)
--------------------------------------
    Unicycler now applies to the graph in decreasing order of quality. This ensures that when multiple, contradictory bridges exist, the most supported option is used.

Bridge type   Start → end    Path                                       Quality
SPAdes           47 → -371   -715, -670, 933                             63.170
SPAdes          266 → 65     576                                         63.016
SPAdes          202 → 261    670, 715, -1015                             62.990
SPAdes          -76 → 133    -937, 579, -549                             62.879
SPAdes          146 → 219    -1059                                       60.226
SPAdes          226 → -342   963, 1015, -715                             56.697
SPAdes            8 → -161   512, 850, -917                              55.603
SPAdes          338 → 411    612                                         52.059
SPAdes           79 → 292    812, -1006, -928, -1030, -1028, 748,        51.669
                             -889, -677, -921, -1139, 817, -991, -880          
SPAdes         -234 → 389    -824, -1006                                 47.749
SPAdes         -278 → 375    -595                                        45.812
SPAdes         -166 → 330    1034, 1034                                  40.662
SPAdes           29 → -104   -1050                                       35.419
SPAdes           31 → 12     -488, -663, -587, 1143, 517, 1158, -492     28.618
SPAdes          -11 → 67     596, -1146, 498, -1154, -513, 947, 522,     19.171
                             601, 578, -1167, -537, -1166, -577,               
                             -710, -504, -986, -478, 855, 592                  
SPAdes           49 → 191    492, 1160, -517, -1163, 587, 664, 488,      17.408
                             -495, 612                                         


Bridged assembly graph (2022-06-02 13:40:38)
--------------------------------------------
    The assembly is now mostly finished and no more structural changes will be made. Ideally the assembly graph should now have one contig per replicon and no erroneous contigs (i.e. a complete assembly). If there are more contigs, then the assembly is not complete.


Component   Segments   Links   Length      N50      Longest segment   Status    
    total      1,133   1,857   3,556,826   13,500            98,454             
        1      1,132   1,857   3,549,300   13,500            98,454   incomplete
        2          1       0       7,526    7,526             7,526   incomplete


Assembly complete (2022-06-02 13:40:38)
---------------------------------------
Saving /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/assembly.gfa
Saving /project/6069942/PLASMIDS/YERSINIA_PLASMIDS/assemblies/pdams-SAMN07327716/temp/short/assembly.fasta

